<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="楕円曲線暗号 楕円曲線 $K$ を任意の体、 $f(x) \in K[x]$ を3次方程式とする。ただし $f(x)$ の3解は相異なる。ここで次の方程式を考える。
$$ y^2 = f(x) $$
$x, y$ 線形変換によって2次の項は消すことができ、
$$ y^2 = x^3 + ax + b $$"><title>楕円曲線暗号</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://anko9801.github.io/blog//icon.png><link href=https://anko9801.github.io/blog/styles.708c2658f93e3a9d323a1f9fded8f4b2.min.css rel=stylesheet><link href=https://anko9801.github.io/blog/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://anko9801.github.io/blog/js/darkmode.5777cdbea4ccb2b68cacc7e904cabb5c.min.js></script>
<script src=https://anko9801.github.io/blog/js/util.9825137f5e7825e8553c68ce39ac9e44.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://anko9801.github.io/blog/js/popover.9b72b70bd35617d0635e9d15463662b2.min.js></script>
<script src=https://anko9801.github.io/blog/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://anko9801.github.io/blog/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://anko9801.github.io/blog/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const BASE_URL="https://anko9801.github.io/blog/",fetchData=Promise.all([fetch("https://anko9801.github.io/blog/indices/linkIndex.9eb8c3393707fa458fa0411e31d900bd.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://anko9801.github.io/blog/indices/contentIndex.da67f4d2bd8b1b1f8cf33b1582eb2df0.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://anko9801.github.io/blog",!0,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://anko9801.github.io/blog",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'’':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/anko9801.github.io\/blog\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XYFD95KB4J",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script defer src=https://anko9801.github.io/blog/js/semantic-search.2c776550faf6cf14399b47e62a8e9782.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://anko9801.github.io/blog/>🪴 あやめHex</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>楕円曲線暗号</h1><p class=meta>Last updated
Oct 23, 2022
<a href=https://github.com/anko9801/blog/tree/hugo/content/crypto/ECC/ECC.md rel=noopener>Edit Source</a></p><ul class=tags></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#楕円曲線>楕円曲線</a></li><li><a href=#2重周期関数>2重周期関数</a></li><li><a href=#ペアリング>ペアリング</a></li><li><a href=#超楕円曲線>超楕円曲線</a></li><li><a href=#保型形式>保型形式</a><ol><li><a href=#楕円曲線暗号とは>楕円曲線暗号とは</a></li><li><a href=#楕円曲線とは>楕円曲線とは</a></li><li><a href=#攻撃手法>攻撃手法</a></li><li><a href=#1-ecdlp>1. ECDLP</a></li><li><a href=#2-polig-hellman-attack>2. Polig-Hellman Attack</a></li><li><a href=#3-movfr-reduction>3. MOV/FR Reduction</a></li><li><a href=#4-sssa-attack--supersingularな曲線を用いてはいけない>4. SSSA Attack / Supersingularな曲線を用いてはいけない</a></li><li><a href=#5-singularな曲線を用いてはいけない>5. Singularな曲線を用いてはいけない</a></li><li><a href=#6-invalid-curve-attack>6. Invalid Curve Attack</a></li><li><a href=#weil-decsent>Weil decsent</a></li><li><a href=#ecfft>ECFFT</a></li></ol></li></ol></nav></details></aside><a href=#楕円曲線暗号><h1 id=楕円曲線暗号><span class=hanchor arialabel=Anchor># </span>楕円曲線暗号</h1></a><a href=#楕円曲線><h2 id=楕円曲線><span class=hanchor arialabel=Anchor># </span>楕円曲線</h2></a><p>$K$ を任意の体、 $f(x) \in K[x]$ を3次方程式とする。ただし $f(x)$ の3解は相異なる。ここで次の方程式を考える。</p><p>$$
y^2 = f(x)
$$</p><p>$x, y$ 線形変換によって2次の項は消すことができ、</p><p>$$
y^2 = x^3 + ax + b
$$</p><ul><li>グラフ(一般性なし)</li><li>特異性 -> 無限遠点</li><li>和</li></ul><p><img src="/blog/Pasted image 20220907220335.png" width=auto></p><p>$C: F(x, y) = 0$ について
$C$ が点 $(x_0, y_0)$ で非特異であるとは2つの偏微分 $\partial F/\partial x, \partial F/\partial y$ のうちの1つが $(x_0, y_0)$ で $0$ でないということである。$K&rsquo;$ が実数体 $\mathbb{R}$ であるとき $C$ がその点で接線を持つための条件と一致する。 $F(x, y) = y^2 - f(x)$ の場合、偏微分は $- f&rsquo;(x_0)$ と $2y_0$ である。2つの微分が同時に $0$ であるためには、 $y_0 = 0$ かつ $x_0$ は $f(x)$ の重解であることが必要十分である。この理由の為に楕円曲線の定義において、$f(x)$ が相違なる根を持つということを仮定したのである。つまり楕円曲線はすべての点において非特異である。</p><p>楕円曲線上の点全体に加えてその曲線上に存在すると考えたいきわめて重要な無限遠点と呼ばれるものがある。これは複素関数論において、複素平面に無限遠点を添加してリーマン球面を形成することと同じようなものである。このことを正確に扱う為に今、射影座標を導入する。</p><p>単項式 $x^iy^j$ の全次数(total degree) とは $i + j$ を意味する。多項式 $F(x,y)$ の全次数とは、 $0$ でない係数を持って出てくる単項式の全次数の最大値を意味する。$F(x,y)$ の全次数が $n$ のとき、対応する $3$ 変数の同次多項式 $\widetilde{F}(x,y,z)$ を $F(x,y)$ における各多項式 $x^iy^j$ に、 $x, y, z$ に関する全次数が $n$ になるように $z^{n-i-j}$ を掛けて得られる多項式と定義する。言い換えると</p><p>$$
\widetilde{F}(x,y,z) = z^nF\left(\frac{x}{z}, \frac{y}{z}\right)
$$</p><p>となる。例えば楕円曲線の1つ $F(x, y) = y^2 - (x^3 + ax + b)$</p><p>$$
\begin{aligned}
\widetilde{F}(x,y,z) &= y^2z - x^3 - axz^2 - bz^3 \\ \end{aligned}
$$</p><p>$\widetilde{F}(x, y, 1) = F(x, y)$ とか $\widetilde{F}(\lambda x,\lambda y,\lambda z) = \lambda^n\widetilde{F}(x, y, z)$ みたいな性質がある。</p><p>無限遠点の解説
自明な3つ組 $(0,0,0)$ を除いた射影平面 $\mathbb{P}_K^2$ を非自明な3つ組の同値類を体のなす集合として定義する。
射影平面を同値類で考えることが好きな正常な人間などいるわけないが、ありがたいことにこれを幾何学的に考えることができる。
$(x,y,z)$ の同値類
${(x,1,0)\\ |\\ x \in K}$ は $y = 1$ の直線と無限遠点 $(1,0,0)$ の和として視覚化できる。</p><p>和の定義
群構造をなす証明</p><p>和の定義
楕円曲線上の点 $P, Q$ に対し、直線 $PQ$ と曲線との交点の $y$ 座標を符号反転した点を $P + Q$ とします。</p><p><img src="/blog/Pasted image 20220907220413.png" width=auto></p><p>この定義を踏まえて、具体的に式を立てて計算すると $P(x_1, y_1), Q(x_2, y_2)$ として $R(x_3, y_3) = P + Q$ は次のように計算できます。ただし、$P = Q$ のときの直線 $PQ$ は曲線に対する点 $P$ の接線と考えます。</p><p>$$
\begin{aligned}
x_3 &= \lambda^2 - x_1 - x_2 \\ y_3 &= \lambda(x_1 - x_3) - y_1 \\ \lambda &=
\begin{dcases}
\frac{y_2 - y_1}{x_2 - x_1} \quad (P \neq Q) \\ \frac{3x_1^2 + a}{2y_1} \quad (P = Q)
\end{dcases}
\end{aligned}
$$</p><a href=#2重周期関数><h2 id=2重周期関数><span class=hanchor arialabel=Anchor># </span>2重周期関数</h2></a><p>複素平面内の格子 $L$ とは、与えられた2つの複素数 $\omega_1, \omega_2$ の整数係数の1次結合全体のなす集合を意味する。ただし、$\omega_1$ と $\omega_2$ は原点を通る同一の直線状に無いものとする。
例えば $\omega_1 = 1, \omega_2 = i$ の場合、ガウス整数全体のなす格子 ${m + ni\\ |\\ m, n \in \mathbb{Z}}$ を得る。
基本平行四辺形</p><p>$$
\begin{aligned}
L &= {m\omega_1 + n\omega_2\\ |\\ m, n \in \mathbb{Z}} \\ \Pi &= {a\omega_1 + b\omega_2\\ |\\ 0 \leq a \leq 1, 0 \leq b \leq 1} \\ \end{aligned}
$$</p><p>与えられた格子 $L$ に対し、 $\mathbb{C}$ 上の有理型関数 $f$ はすべての $\lambda \in L$ について $f(z + \lambda) = f(z)$ になるとき、 $L$ に関する楕円関数と言われる。 $\lambda = \omega_1$ と $\lambda = \omega_2$ についてこの性質を確認すれば十分であることを注意しておく。</p><p>2重周期関数
複素多様体 トーラス
実多様体 円</p><p>楕円関数の重要な例となるものを定義する。この関数はワイエルシュトラスの $\wp$ -関数(ペー関数)と呼ばれる。</p><p>$$
\wp(z) = \wp(z; L) = \frac{1}{z^2} + \sum_{\lambda \in L, \lambda \neq 0} \left(\frac{1}{(z-\lambda)^2} - \frac{1}{\lambda^2} \right)
$$</p><p>$$
\begin{aligned}
\wp(z) &= \frac{1}{z^2} + \sum_{\lambda \in L, \lambda \neq 0} \left(\frac{1}{(z-\lambda)^2} - \frac{1}{\lambda^2} \right) \\ &= \frac{1}{z^2} + \sum_{\lambda \in L, \lambda \neq 0} \frac{1}{\lambda^2}\left(\frac{1}{(1-z/\lambda)^2} - 1\right) \\ &= \frac{1}{z^2} + \sum_{\lambda \in L, \lambda \neq 0} \frac{1}{\lambda^2}\sum_{k=1}^{\infty}(k+1)\left(-\frac{z}{\lambda}\right)^k \\ &= \frac{1}{z^2} + \sum_{k=1}^{\infty}(k+1)(-1)^k\sum_{\lambda \in L, \lambda \neq 0} \frac{1}{\lambda^{k+2}}z^k \\ &= \frac{1}{z^2} + \frac{g_2}{20}z^2 + \frac{g_3}{28}z^4 + \mathcal{O}(z^6) \\ g_2 &:= 60\sum_{\lambda \in L}\frac{1}{\lambda^4}, \quad
g_3 := 140\sum_{\lambda \in L}\frac{1}{\lambda^6} \\ \end{aligned}
$$</p><p>$$
\begin{aligned}
\wp&rsquo;(z) &= -2\sum_{\lambda \in L} \frac{1}{(z-\lambda)^3} \\ &= - \frac{2}{z^3} + 2\sum_{\lambda \in L,\lambda\neq0} \frac{1}{\lambda^3}\sum_{k=0}^{\infty}(2k+1)\left(\frac{z}{\lambda}\right)^k \\ &= 2\sum_{k=0}^{\infty} (2k+1)\sum_{\lambda \in L,\lambda\neq0}\frac{1}{\lambda^{k+3}}z^k
\end{aligned}
$$</p><p>$$
\begin{aligned}
\wp(z) &= \frac{1}{z^2} + \frac{g_2}{20}z^2 + \frac{g_3}{28}z^4 + \mathcal{O}(z^6) \\ \wp&rsquo;(z) &= -\frac{2}{z^3} + \frac{g_2}{10}z + \frac{g_3}{7}z^3 + \mathcal{O}(z^5) \\ \wp^3(z) &= \frac{1}{z^6} + \frac{3g_2}{20}\frac{1}{z^2} + \frac{3g_3}{28} + \mathcal{O}(z^2) \\ \wp&rsquo;^2(z) &= \frac{4}{z^6} - \frac{2g_2}{5}\frac{1}{z^2} - \frac{4g_3}{7} + \mathcal{O}(z^2) \\ \end{aligned}
$$</p><p><img src="/blog/Pasted image 20220907220319.png" width=auto></p><p><img src="/blog/Pasted image 20220907220303.png" width=auto>
楕円関数体
楕円曲線</p><a href=#ペアリング><h2 id=ペアリング><span class=hanchor arialabel=Anchor># </span>ペアリング</h2></a><p>weil pairing
tate pairing
大人数
ペアリング</p><a href=#超楕円曲線><h2 id=超楕円曲線><span class=hanchor arialabel=Anchor># </span>超楕円曲線</h2></a><p>超楕円曲線
ヤコビ多様体</p><a href=#保型形式><h2 id=保型形式><span class=hanchor arialabel=Anchor># </span>保型形式</h2></a><p>上半平面 $\mathbb{H}$</p><p>$$
\gamma(x) = \frac{ax + b}{cx + d}
$$</p><p>の変換について不変</p><p>同型写像
SIDH
楕円曲線暗号をそこまで理解してないので、これから学ぶ人がより先へ開拓していき、よりよい記事が出されることを期待しています。</p><a href=#楕円曲線暗号とは><h3 id=楕円曲線暗号とは><span class=hanchor arialabel=Anchor># </span>楕円曲線暗号とは</h3></a><p>楕円曲線暗号 (ECC) はRSA暗号と同時期に開発された暗号で1985年頃に Victor S. Miller と Neal Koblitz が同時期かつ独立に発明しました(ちなみにMiller-Rabin素数判定法のMillerはGary L. Millerで別人です)。特徴としてRSA暗号よりも純粋に強い暗号であることや同じ強度のRSA暗号と比べて鍵長が短いなどがあります。</p><p>楕円曲線というのは次の関数からなる曲線のことです。</p><p>$$
y^2 = x^3 + ax + b
$$</p><p>ここにグラフ</p><p>楕円曲線上の点 $P, Q$ に対し、直線 $PQ$ と曲線との交点の $y$ 座標を符号反転した点を $P + Q$ とします。</p><p>ここに図</p><p>この定義を踏まえて、具体的に式を立てて計算すると $P(x_1, y_1), Q(x_2, y_2)$ として $R(x_3, y_3) = P + Q$ は次のように計算できます。ただし、$P = Q$ のときの直線 $PQ$ は曲線に対する点 $P$ の接線と考えます。</p><p>$$
\begin{aligned}
x_3 &= \lambda^2 - x_1 - x_2 \\ y_3 &= \lambda(x_1 - x_3) - y_1 \\ \lambda &=
\begin{dcases}
\frac{y_2 - y_1}{x_2 - x_1} \quad (P \neq Q) \\ \frac{3x_1^2 + a}{2y_1} \quad (P = Q)
\end{dcases}
\end{aligned}
$$</p><p>ここに具体例</p><p>また加法について群となることが証明でき結合法則 $P + (Q + R) = (P + Q) + R$ が成り立つことが証明でき、$nP = \underbrace{P + P + \ldots + P}_n$ と書けます。これを楕円曲線上のスカラー積と呼びます。</p><p>ここに具体例</p><p>$8P$</p><p>ここに実装</p><p>さて、ここでこの楕円曲線上の加法を用いた次のような問題を作れます。</p><hr><p>楕円曲線上の点 $P, Q$ に $Q=dP$ という関係があるとき $d$ を求めよ。</p><hr><p>つまり楕円曲線の世界で「割り算」をしなさいという問題です。</p><p>実はこの問題はとても難しく、これを解く効率的なアルゴリズムは現在見つかっていません。これを楕円曲線上の離散対数問題 (ECDLP : Elliptic Curve Discrete Logarithm Problem) と呼びます。この ECDLP を利用して暗号の形にしたものが楕円曲線暗号です。</p><p>具体例としては色々ありますがCTFで最もよく出るのがECDHです。</p><a href=#ecdh-elliptic-curve-diffiehellman-key-exchange><h4 id=ecdh-elliptic-curve-diffiehellman-key-exchange><span class=hanchor arialabel=Anchor># </span>ECDH (Elliptic curve Diffie–Hellman key exchange)</h4></a><p>暗号通信をする為に使われる暗号プロトコルです。</p><p>Alice と Bob は AES などの共通鍵暗号を用いて暗号通信しようとしていますが、始めに2人だけの秘密である共有鍵が必要です。しかしそれを直接共有してしまうと、第三者から鍵を盗聴されて通信を覗き見られてしまいます。そこで暗号を用いることで鍵を直接共有することなく共有鍵を構築することができます。この手法をディフィーヘルマン鍵共有 (DH) と呼び、DH の中でも ECDLP を安全性根拠とする DH を楕円曲線ディフィーヘルマン鍵共有 (ECDH) と呼びます。</p><p>具体的には次のような方法で ECDH を実現します。</p><p>ここに図</p><ol><li>AliceとBobが楕円曲線のパラメータとベースポイント $G$ を共有する。</li><li>AliceとBobはそれぞれランダムな値 $d_A, d_B$ を生成し、$d_A, d_B$ を秘密鍵、$Q_A = d_AG, Q_B = d_BG$ を公開鍵として公開する。</li><li>AliceとBobは自分の秘密鍵と相手の公開鍵を掛けると $S = d_Ad_BG = d_AQ_B = d_BQ_A$ となり、$S$ の $x$ 座標をハッシュ化したものが Alice と Bob のみが知る共通鍵となる。</li></ol><p>このように攻撃者は $(G, dG)$ が分かっても ECDLP が解けない為に $d$ が分からず、安全に共通鍵を共有することができます。</p><p>ここに実装</p><p>暗号標準を定める国際機関によって楕円曲線が
<a href=https://neuromancer.sk/std/ rel=noopener>https://neuromancer.sk/std/</a></p><a href=#楕円曲線とは><h3 id=楕円曲線とは><span class=hanchor arialabel=Anchor># </span>楕円曲線とは</h3></a><p>掴みを見れたと思うのですがよく理解するには正確な定義が必要です。
数学的な話はあんまり</p><p>射影平面上の楕円曲線</p><p>射影平面で定義する理由</p><ul><li>無限遠点を数学的に定義できる</li><li>実装時に割り算の遅延ができ高速化できる</li></ul><p>さてそろそろ攻撃したくてムズムズし始めたんじゃないでしょうか？ではやっていきましょう！</p><a href=#攻撃手法><h3 id=攻撃手法><span class=hanchor arialabel=Anchor># </span>攻撃手法</h3></a><p>この ECDLP を解くことができれば ECDH を含め、様々な楕円曲線暗号を解くことができます。さて主に攻撃対象となる楕円曲線暗号は以下のようなものがあります。</p><ol><li>現在見つかっている最も高速なアルゴリズムで ECDLP を解く。計算量は $O(\sqrt{#E/\mathbb{F}_p})$ となる。</li><li>$#E/\mathbb{F}_p = p_1^{e_1}p_2^{e_2}\ldots p_k^{e_k}$ (位数が Smooth number なとき) ならば位数 $p_i$ の小さな ECDLP に分解できる。それぞれ計算量は $O(\sqrt{p_i})$ である。</li><li>$#E/\mathbb{F}_p = p$ (Anomalous なとき) ならば $\mathbb{F}_p^+$ 上の DLP に帰着できる。</li><li>$#E/\mathbb{F}<em>p = p+1$ (Supersingular なとき) ならば埋め込み次数 $k$ を用いて $\mathbb{F}</em>{p^k}^\times$ 上の DLP に帰着できる。実践上 $k$ はそこまで大きくならない。</li><li>$\Delta(E/\mathbb{F}_p) = 0$ (Singular なとき) ならば $\mathbb{F}_p^+$ や $\mathbb{F}<em>p^\times, \mathbb{F}</em>{p^2}^\times$ 上の DLP に帰着できる。</li><li>楕円曲線上に存在しない点や位数の少ない点を指定できるならば秘密鍵の情報を取り出すことができる。</li></ol><p>それぞれ</p><a href=#1-ecdlp><h3 id=1-ecdlp><span class=hanchor arialabel=Anchor># </span>1. ECDLP</h3></a><a href=#2-polig-hellman-attack><h3 id=2-polig-hellman-attack><span class=hanchor arialabel=Anchor># </span>2. Polig-Hellman Attack</h3></a><a href=#3-movfr-reduction><h3 id=3-movfr-reduction><span class=hanchor arialabel=Anchor># </span>3. MOV/FR Reduction</h3></a><p>MOV Reduction (Menezes-Okamoto-Vanstone Reduction)
Weil-pairing
FR Reduction (Frey-Rück Reduction)
Tate-pairing</p><p>Tate-pairing, Bilinear-pairingのいい資料がみつからない</p><a href=#4-sssa-attack--supersingularな曲線を用いてはいけない><h3 id=4-sssa-attack--supersingularな曲線を用いてはいけない><span class=hanchor arialabel=Anchor># </span>4. SSSA Attack / Supersingularな曲線を用いてはいけない</h3></a><p>$E/\mathbb{F}_q, \gcd(t, q) > 1$ 埋め込み次数 $k\leq6$ 全埋込み次数は既知
$E[p] \mathbb{Z}/p\mathbb{Z}$
$\pi:\mathbb{P}^2(\mathbb{Q}_p) \to \mathbb{P}^2(\mathbb{F}_p)$
$\phi:\ker\pi \to \mathcal{E}(p\mathbb{Z}_p)$</p><a href=#5-singularな曲線を用いてはいけない><h3 id=5-singularな曲線を用いてはいけない><span class=hanchor arialabel=Anchor># </span>5. Singularな曲線を用いてはいけない</h3></a><p>Singular な楕円曲線の場合、特異点が存在し、特異点には尖点 (cusp) 、節点 (node) の2種類がある。$c_4 = 0$ と尖点は同値である。</p><p>$y = 0$ 上の特異点が原点 $O(0, 0)$ となるように平行移動させる。すると任意の Singular な楕円曲線は $y^2 = x^3 + kx^2$ の形となる。</p><p>$$
\begin{aligned}
\begin{dcases}
E(\mathbb{F}_p) \rightarrow \mathbb{F}_p^+: (x,y)↦\frac{x}{y},&∞↦0 & (cuspのとき)\\ E(\mathbb{F}_p) \rightarrow \mathbb{F}_p^\times: (x,y)↦\frac{y + \sqrt{k}x}{y - \sqrt{k}x},&∞↦1 & (nodeのとき) \\ \end{dcases}
\end{aligned}
$$</p><p>↑これはなぜ？</p><a href=#6-invalid-curve-attack><h3 id=6-invalid-curve-attack><span class=hanchor arialabel=Anchor># </span>6. Invalid Curve Attack</h3></a><a href=#weil-decsent><h3 id=weil-decsent><span class=hanchor arialabel=Anchor># </span>Weil decsent</h3></a><a href=#ecfft><h3 id=ecfft><span class=hanchor arialabel=Anchor># </span>ECFFT</h3></a><p>より面白い話題として楕円曲線暗号にバックドアが仕込まれていたという事件がある。</p><ul><li>Dual EC DRBG</li></ul><p>構成</p><ul><li>SIDH SIKE</li><li>ECDH</li><li>CSIDH</li></ul><p><a href=https://blog.z.cash/new-snark-curve/ rel=noopener>https://blog.z.cash/new-snark-curve/</a> : BLS12-381: New zk-SNARK Elliptic Curve Construction
unefficient key recovery</p><p>Diffie Hellman
E/P/Q = E/Q/P
ECDDH
E/P E/Q -> E/PQ</p><p>Call Stack Graph
エラーが起きたところをいい感じにたどれる</p></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li>No backlinks found</li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://anko9801.github.io/blog/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p>Made by Jacky Zhao using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2022</p><ul><li><a href=https://anko9801.github.io/blog/>Home</a></li><li><a href=https://twitter.com/Anko_9801>Twitter</a></li><li><a href=https://github.com/anko9801>Github</a></li></ul></footer></div></div></body></html>