$\newcommand{\ZZ}{\mathbb{Z}}$
---
"title": "Tonelli Shanks"
---


## 説明
$x^2 = a \pmod p$ の $x$ を求める.
$xa = a^p$ なのでやりたいことは $x = a^{p/2}$
$$
\begin{aligned}
x^2 &= a = a^p \pmod p \\
x &= a^{p/2}
\end{aligned}
$$
$\ZZ/(p-1)\ZZ \cong \ZZ/q\ZZ \times \ZZ/2^Q\ZZ$
$f:\ZZ/q\ZZ \times \ZZ/2^Q\ZZ \to \ZZ/q\ZZ \times \ZZ/2^Q\ZZ$
$f:(a_1, a_2) \mapsto (1, w)$
$a^{(q + 1)/2}$ $a$
