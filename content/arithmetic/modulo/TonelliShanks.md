$\newcommand{\ZZ}{\mathbb{Z}}$
---
"title": "Tonelli Shanks"
---


## 説明
$x^2 = a \pmod p$ の $x$ を求める.
$x^2 = a = a^p$ なのでやりたいことは $x = a^{p/2}$ である。
$(\ZZ/p\ZZ)^\times \cong \ZZ/(p-1)\ZZ \cong \ZZ/q\ZZ \times \ZZ/2^Q\ZZ$
右シフトは難しいが左シフトは簡単
$2\mathrm{ind}(x) - \mathrm{ind}(a)$
$f:\ZZ/q\ZZ \times \ZZ/2^Q\ZZ \to \ZZ/q\ZZ \times \ZZ/2^Q\ZZ$
$f:(a_1, a_2) \mapsto (0, w)$
$a^{(q + 1)/2}$ $a$
