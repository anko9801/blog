---
title: "glibc heap exploitation を支える技術"
---

この記事を和訳します。
https://0x434b.dev/overview-of-glibc-heap-exploitation-techniques/

この記事では広く知られている GLIBC heap exploitation の技術の全体像を見ることを目的としています。実際の攻撃は読者への課題とします。blah blah

## Heap Exploit の基礎
### Chunks
![[Pasted image 20221228215339.png]]

### Bins
Bins とはまだ割り当てられていないチャンクのリストです。Bins はチャンクのサイズによって管理の仕方が異なります。次にそれらを簡単に紹介します。

#### fastbins
チャンクサイズが 0x20 から 0xb0 のとき fastbins という LIFO の単方向連結リストに繋がれます。各 fastbin の先頭は arena にあります。チャンクの userdata の最初の qword は fastbins の次のチャンクを指す forward pointer (fd) でが置かれ、リストの最後の fd は NULL になります。tcache が既にいっぱいのとき対応する fastbins に入ります。
fastbins の範囲のチャンクサイズのメモリ確保を行う場合、tcachebin->fastbin->unsortedbin->top_chunkの順に探します。
![[Pasted image 20221228220533.png]]

#### smallbins
チャンクサイズが 0x20 から 0x3f0 のとき smallbins という FIFO の双方向循環リストに繋がれます。各 smallbins の先頭は arena にあります。unsortedbins でソートが起こったときのみ smallbins に入ります。fd bk

![[Pasted image 20221229000853.png]]